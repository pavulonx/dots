#!/bin/sh

follow=false
force_color=false
for arg; do
  case "$arg" in
    -f|--follow) follow=true ;;
    -c|--color)  force_color=true ;;
    *) ;;
  esac
done

lastlog="$XDG_CACHE_HOME/xstart/latest.log"

! [ -f "$lastlog" ] && echo "File $lastlog does not exist!" >&2 && exit 1

printer='cat'
"$follow" && printer='tail -f'

if [ -t 1 ] || "$force_color"; then # colorize outfut when connected to terminal

  $printer "$lastlog" | sed '
  s/\[ERR\] |/\x1b[31;1m[ERR]\x1b[0m |/g
  s/\[OUT\] |/\x1b[1m[OUT]\x1b[0m |/g
  '

else
  $printer "$lastlog"
fi
